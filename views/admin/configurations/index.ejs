<%- include ('.././elements/header') %>

    <% const allconfigurations=JSON.parse(srcData); %>

        <div class="main-content">
            <div id="flashMessage" class="alert alert-success" style="display: none;"></div>

            <table id="configurationTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Configuration For</th>
                        <th>Latest App Version</th>
                        <th>Updation Compulsory</th>
                        <th>Last Updated</th>
                        <th>Action</th>
                    </tr>
                </thead>

                <tbody id="configurationTable"></tbody>
            </table>

        </div>

        <%- include ('.././elements/footer.ejs') %>

            <!-- Include necessary JavaScript files for DataTables and jQuery -->
            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
            <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.x.x/dist/js/bootstrap.bundle.min.js"></script>
            <script src="https://code.jquery.com/jquery-3.6.0.min.js"
                integrity="sha256-4+X4O3XKXU7oW58ILME1eULlhLPiTiEUn5buoZt2H14=" crossorigin="anonymous"></script>
            <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
            <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
            <script>

                function showMessage(message) {
                    $('#message').text(message);
                }

                $(document).ready(function () {
                    var srcData = JSON.parse(`<%- srcData %>`); // Parse the JSON string to an array of objects

                    $('#configurationTable').DataTable({
                        pageLength: 10,
                        data: srcData,
                        columns: [
                            {
                                data: null,
                                render: function (data, type, row, meta) {
                                    return meta.row + 1;
                                },
                            },
                            { data: 'configurationFor' },
                            { data: 'latestAppVersion' },
                            {
                                data: 'isForcefullyUpdateNeeded',
                                title: 'Force Update Required',
                                render: function (data, type, row) {
                                    // Return the dropdown HTML with selected option based on the current value
                                    return ` ${row.isForcefullyUpdateNeeded == 1 ? 'Yes' : 'No'}`;
                                }
                            },
                            {
                                data: 'updatedAt',
                                render: function (data, type, row) {
                                    return moment(data).format('YYYY-MM-DD HH:mm:ss A');
                                }
                            },
                            {
                                data: null,
                                render: function (data, type, row) {
                                    return `
                                    <a href="<%=process.env.nodeAdminUrl%>/edit/configuration/${data.id}" class="btn btn-primary btn-sm" onclick="editUser(${data.id})">
                                     <i class="fas fa-edit"  title="Edit User"></i></a>
                                   
                                    <a href="<%=process.env.nodeAdminUrl%>/views/configuration/${data.id}" class="btn btn-secondary btn-sm" onclick="views(${data.id})"   title="View User" >
                                        <i class="fas fa-eye"></i> 
                                    </a>
                                  `;
                                }
                            }
                        ],
                    });
                });
            </script>